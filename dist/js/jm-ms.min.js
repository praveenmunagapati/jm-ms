!function e(t,r,n){function o(u,a){if(!r[u]){if(!t[u]){var l="function"==typeof require&&require;if(!a&&l)return l(u,!0);if(i)return i(u,!0);throw new Error("Cannot find module '"+u+"'")}var s=r[u]={exports:{}};t[u][0].call(s.exports,function(e){var r=t[u][1][e];return o(r||e)},s,s.exports,e,t,r,n)}return r[u].exports}for(var i="function"==typeof require&&require,u=0;u<n.length;u++)o(n[u]);return o}({1:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){var t=new o.default(e);return t.use(i.default.moduleClient).use(u.default.moduleClient),t};var o=n(e("jm-ms-core")),i=n(e("jm-ms-http/lib/browser")),u=n(e("jm-ms-ws/lib/browser"));t.exports=r.default},{"jm-ms-core":4,"jm-ms-http/lib/browser":17,"jm-ms-ws/lib/browser":26}],2:[function(e,t,r){(function(e){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(){function e(){n(this,e),this._events={}}return o(e,[{key:"on",value:function(e,t,r){return this._events[e]||(this._events[e]=[]),r?this._events[e].unshift(t):this._events[e].push(t),this}},{key:"once",value:function(e,t,r){var n=this;return this.on(e,function r(o,i,u,a,l){n.off(e,r),t(o,i,u,a,l)},r)}},{key:"off",value:function(e,t){if(t){if(this._events&&this._events[e])for(var r=this._events[e],n=0;n<r.length;n++)if(t===r[n]){r.splice(n,1),r.length||delete this._events[e];break}}else void 0===e?this._events={}:this._events&&this._events[e]&&delete this._events[e];return this}},{key:"emit",value:function(e,t,r,n,o,i){for(var u=this.listeners(e),a=0;a<u.length&&!1!==(0,u[a])(t,r,n,o,i);a++);return this}},{key:"eventNames",value:function(){return Object.keys(this._events)}},{key:"listeners",value:function(e){var t=this._events[e];if(!t)return[];for(var r=new Array(t.length),n=0;n<t.length;n++)r[n]=t[n];return r}}]),e}(),u=i.prototype,a={_events:{},on:u.on,once:u.once,off:u.off,emit:u.emit,eventNames:u.eventNames,listeners:u.listeners},l=function(e){if(void 0!==e.emit)return!1;var t=!0,r=!1,n=void 0;try{for(var o,i=Object.keys(a)[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var u=o.value;e[u]=a[u]}}catch(e){r=!0,n=e}finally{try{!t&&i.return&&i.return()}finally{if(r)throw n}}return e._events={},!0},s=function(e){if(void 0!==e.emit){var t=!0,r=!1,n=void 0;try{for(var o,i=Object.keys(a)[Symbol.iterator]();!(t=(o=i.next()).done);t=!0)delete e[o.value]}catch(e){r=!0,n=e}finally{try{!t&&i.return&&i.return()}finally{if(r)throw n}}}},f={EventEmitter:i,enableEvent:l,disableEvent:s,moduleEvent:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"event",t=this;return t.enableEvent=l,t.disableEvent=s,{name:e,unuse:function(){delete t.enableEvent,delete t.disableEvent}}}};if(void 0!==e&&e){e.jm||(e.jm={});var c=e.jm;if(!c.EventEmitter)for(var d in f)c[d]=f[d]}r.default=f,t.exports=r.default}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],3:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=1;r.default={FA_INVALIDTYPE:{err:n++,msg:"invalid type"}},t.exports=r.default},{}],4:[function(e,t,r){(function(n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=o(e("jm-err")),l=o(e("jm-event")),s=o(e("jm-module")),f=o(e("./utils")),c=o(e("./router")),d=o(e("./err")),p=function(){function e(){i(this,e),a.default.enableErr(this),s.default.enableModule(this),this.utils=f.default,this.clientModules={},this.serverModules={}}return u(e,[{key:"router",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this,r=new c.default(e);return r.proxy=function(e,n,o,i){var u=e;if("string"==typeof e?(u={uri:e,target:n},"boolean"==typeof o?u.changeOrigin=o:o&&"function"==typeof o&&(i=o)):i=n,u||(u={}),i||(i=function(e,t){if(e)throw e}),!u.target){var a=ms.Err.FA_PARAMS,l=ms.err(a);i(l,a)}this.emit("proxy",u),"string"==typeof u.target&&(u.target={uri:u.target}),u.changeOrigin?t.client(u.target,function(e,t){if(e)return i(e,t);r.use(u.uri,function(e,r){t.request(e,r)}),i(e,t)}):t.proxy(u.target,function(e,t){if(e)return i(e,t);r.use(u.uri,t),i(e,t)})},r}},{key:"client",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=null,n=null,o="http";e.uri&&(o=f.default.getUriProtocol(e.uri)),e.type&&(o=e.type),o=o.toLowerCase();var i=this.clientModules[o];return i?i(e,function(e,r){e||f.default.enableType(r,["get","post","put","delete"]),t&&t(e,r)}):(n=d.default.FA_INVALIDTYPE,r=this.err(n),t&&t(r,n)),this}},{key:"server",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=null,o=null,i="http";t.uri&&(i=f.default.getUriProtocol(t.uri)),t.type&&(i=t.type),i=i.toLowerCase();var u=this.serverModules[i];return u?(e.emit("server",t),u(e,t,r)):(o=d.default.FA_INVALIDTYPE,n=this.err(o),r&&r(n,o)),this}},{key:"proxy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=null,n=null;if("string"==typeof e&&(e={uri:e}),!e.uri&&(n=this.Err.FA_PARAMS,r=this.err(n),!t))throw r;var o=this.router();return this.client(e,function(e,r){if(e)return t(e,r);o.use(function(e,t){r.request(e,t)}),o.client=r,t&&t(null,o)}),o}}]),e}();if(void 0!==n&&n){n.jm||(n.jm={});var v=n.jm;if(!v.ms){var y=new p;v.ms=function(e){return y.router(e)};var m=v.ms;l.default.enableEvent(m),m.root=y,m.proxy=function(e,t){y.proxy(e,t)},m.client=function(e,t){y.client(e,t)},m.server=function(e,t){y.server(e,t)}}}r.default=p,t.exports=r.default}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./err":3,"./router":6,"./utils":7,"jm-err":8,"jm-event":11,"jm-module":12}],5:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(e){return e&&e.__esModule?e:{default:e}}(e("path-to-regexp")),u=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n(this,e),this.uri=t.uri||"/",this.type=t.type,this._fns=[],this.keys=[],t.router&&(this.router=t.router),this.regexp=(0,i.default)(this.uri,this.keys,t),"/"===this.uri&&!1===t.end&&(this.regexp.fast_slash=!0),void 0===this.type&&(this.allType=!0);var r=t.fn;Array.isArray(r)||(r=[r]);for(var o=0;o<r.length;o++){var u=r[o];if("function"!=typeof u){var a="requires callback functions but got a "+toString.call(u);throw new TypeError(a)}this._fns.push(u)}}return o(e,[{key:"handle",value:function(e,t,r){function n(u,a){if(u)return"route"===u?r():t(u,a);var l=i[o++];if(!l)return r(u);try{l(e,t,n)}catch(u){n(u)}}var o=0,i=this.fns;if(0===i.length)return r();n()}},{key:"match",value:function(e,t){if(this.params=void 0,this.uri=void 0,t&&(t=t.toLowerCase()),t!==this.type&&!this.allType)return!1;if(null===e||void 0===e)return!1;if(this.regexp.fast_slash)return this.params={},this.uri="",!0;var r=this.regexp.exec(e);if(!r)return!1;this.params={},this.uri=r[0];for(var n=this.keys,o=this.params,i=1;i<r.length;i++)o[n[i-1].name]=r[i];return!0}},{key:"fns",get:function(){return this._fns}}]),e}();r.default=u,t.exports=r.default},{"path-to-regexp":14}],6:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=n(e("./route")),l=n(e("./utils")),s=n(e("jm-err")),f=n(e("jm-event")),c=s.default.Err,d=s.default.err(c.FA_NOTFOUND),p=function(e,t){},v=Array.prototype.slice,y=function(){function e(){var t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o(this,e),this._routes=[],["mergeParams","sensitive","strict"].forEach(function(e){r[e]&&(t[e]=r[e])}),l.default.enableType(this,["get","post","put","delete"]),f.default.enableEvent(this)}return u(e,[{key:"clear",value:function(){return this._routes=[],this}},{key:"_add",value:function(e,t){var r=null,n=null;if((e=e||{}).uri&&e.fn){this.emit("add",e);var o={};for(var i in e)o[i]=e[i];void 0===o.mergeParams&&(o.mergeParams=this.mergeParams),void 0===o.sensitive&&(o.sensitive=this.sensitive),void 0===o.strict&&(o.strict=this.strict),this._routes.push(new a.default(o))}else if(n=c.FA_PARAMS,r=s.default.err(n),!t)throw r;return t&&t(r,n),this}},{key:"add",value:function(e,t){return"string"==typeof e&&(e={uri:e},"string"==typeof t?(e.type=t,Array.isArray(arguments[2])?e.fn=arguments[2]:e.fn=v.call(arguments,2)):Array.isArray(t)?e.fn=t:e.fn=v.call(arguments,1),t=null),this._add(e,t)}},{key:"_use",value:function(t,r){var n=null,o=null;if((t=t||{})&&t instanceof e&&(t={fn:t}),t.fn){if(this.emit("use",t),t.strict=!1,t.end=!1,t.uri=t.uri||"/",t.fn instanceof e){var u=t.fn;t.router=u,t.fn=function(e,t,r){u.handle(e,t,r)}}else if("object"===i(t.fn)){var a=t.fn;a.request?(t.router=a,t.fn=function(e,t,r){a.request(e,function(e,n){t(e,n),r()})}):a.handle&&(t.router=a,t.fn=function(e,t,r){a.handle(e,t,r)})}return this._add(t,r)}if(o=c.FA_PARAMS,n=s.default.err(o),!r)throw n;return r&&r(n,o),this}},{key:"use",value:function(e,t){return"string"==typeof e?(e={uri:e},"object"===(void 0===t?"undefined":i(t))?e.fn=t:e.fn=v.call(arguments,1),t=null):"function"==typeof e?(e={fn:v.call(arguments,0)},t=null):Array.isArray(e)?(e={fn:e},t=null):"object"===(void 0===e?"undefined":i(e))&&(e.fn||(e={fn:e})),this._use(e,t)}},{key:"request",value:function(e,t){if("object"===(void 0===e?"undefined":i(e)))return this.handle(e,t||p);var r=l.default.preRequest.apply(this,arguments);return this.handle(r.opts,r.cb||p)}},{key:"handle",value:function(e,t,r){function n(o,i){if(o)return"route"===o?r():v(o,i);if(t.done)return v();if(e.baseUri=p,e.uri=y,l>=s.length)return v();for(var u=!1,a=void 0;!u&&l<s.length;)if(a=s[l++])try{u=a.match(e.uri,e.type)}catch(o){return v(o,c.FA_BADREQUEST)}if(!u)return v();e.params={};for(var d in f)e.params[d]=f[d];for(var m in a.params)e.params[m]=a.params[m];a.router&&(e.baseUri=p+a.uri,e.uri=e.uri.replace(a.uri,"")),a.handle(e,t,n)}if(!r){var o=e,i=t;e={};for(var u in o)e[u]=o[u];t=function(e,r){t.done||(t.done=!0,i(e,r))},r=function(e,r){t(e||d,r||c.FA_NOTFOUND)}}var a=this,l=0,s=a.routes,f=e.params,p=e.baseUri||"",v=function(e,t,r,n){return function(o,i){return t.baseUri=r,t.params=n,e&&e(o,i),a}}(r,e,e.baseUri,e.params);e.originalUri||(e.originalUri=e.uri);var y=e.uri;return n(),a}},{key:"routes",get:function(){return this._routes}}]),e}();r.default=y,t.exports=r.default},{"./route":5,"./utils":7,"jm-err":8,"jm-event":11}],7:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(e){return e&&e.__esModule?e:{default:e}}(e("jm-utils")).default.utils;Array.prototype.slice;o.enableType=function(e,t){Array.isArray(t)||(t=[t]),t.forEach(function(t){e[t]=function(r,n,o,i,u){return"string"==typeof r?e.request(r,t,n,o,i,u):(r.type=t,e.request(r,n))}})},o.preRequest=function(e,t,r,o,i,u){if("string"!=typeof e)return{opts:e,cb:t};var a={uri:e},l={opts:a};return void 0===t?l:"function"==typeof t?(l.cb=t,l):("number"==typeof t?a.timeout=t:a.type=t,void 0===r?l:"function"==typeof r?(l.cb=r,l):("number"==typeof r?a.timeout=r:"object"===(void 0===r?"undefined":n(r))&&(a.data=r),void 0===o?l:"function"==typeof o?(l.cb=o,l):("number"==typeof o?a.timeout=o:"object"===(void 0===o?"undefined":n(o))&&(a.params=o),void 0===i?l:"function"==typeof i?(l.cb=i,l):("number"==typeof i&&(a.timeout=i),void 0===u?l:"function"==typeof u?(l.cb=u,l):l))))},r.default=o,t.exports=r.default},{"jm-utils":13}],8:[function(e,t,r){(function(n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=function(e){return e&&e.__esModule?e:{default:e}}(e("./locale")),i={SUCCESS:{err:0,msg:"Success"},FAIL:{err:1,msg:"Fail"},FA_SYS:{err:2,msg:"System Error"},FA_NETWORK:{err:3,msg:"Network Error"},FA_PARAMS:{err:4,msg:"Parameter Error"},FA_BUSY:{err:5,msg:"Busy"},FA_TIMEOUT:{err:6,msg:"Time Out"},FA_ABORT:{err:7,msg:"Abort"},FA_NOTREADY:{err:8,msg:"Not Ready"},FA_NOTEXISTS:{err:9,msg:"Not Exists"},FA_EXISTS:{err:8,msg:"Already Exists"},OK:{err:200,msg:"OK"},FA_BADREQUEST:{err:400,msg:"Bad Request"},FA_NOAUTH:{err:401,msg:"Unauthorized"},FA_NOPERMISSION:{err:403,msg:"Forbidden"},FA_NOTFOUND:{err:404,msg:"Not Found"},FA_INTERNALERROR:{err:500,msg:"Internal Server Error"},FA_UNAVAILABLE:{err:503,msg:"Service Unavailable"}};i.t=o.default;var u=function(e,t){if(t){var r=!0,n=!1,o=void 0;try{for(var i,u=Object.keys(t)[Symbol.iterator]();!(r=(i=u.next()).done);r=!0){var a=i.value;e=e.split("${"+a+"}").join(t[a])}}catch(e){n=!0,o=e}finally{try{!r&&u.return&&u.return()}finally{if(n)throw o}}}return e},a=function(e,t){"string"==typeof e&&(e={msg:e});var r=u(e.msg,t),n=new Error(r);return e.err&&(n.code=e.err),n},l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Err";return!e[t]&&(e[t]=i,e.err=a,e.errMsg=u,!0)},s={Err:i,errMsg:u,err:a,enableErr:l,disableErr:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Err";e[t]&&(delete e[t],delete e.err,delete e.errMsg)}};if(void 0!==n&&n){n.jm||(n.jm={});var f=n.jm;if(!f.enableErr){l(f);for(var c in s)f[c]=s[c]}}r.default=s,t.exports=r.default}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./locale":9}],9:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,t){return t&&n[t]?n[t][e]:null};var n={zh_CN:function(e){return e&&e.__esModule?e:{default:e}}(e("./zh_CN")).default};t.exports=r.default},{"./zh_CN":10}],10:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default={Success:"成功",Fail:"失败","System Error":"系统错误","Network Error":"网络错误","Parameter Error":"参数错误",Busy:"忙","Time Out":"超时",Abort:"中止","Not Ready":"未准备好","Not Exists":"不存在","Already Exists":"已存在",OK:"OK","Bad Request":"错误请求",Unauthorized:"未验证",Forbidden:"无权限","Not Found":"未找到","Internal Server Error":"服务器内部错误","Service Unavailable":"无效服务"},t.exports=r.default},{}],11:[function(e,t,r){t.exports=e(2)},{}],12:[function(e,t,r){(function(e){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(){function e(){n(this,e),this._modules={}}return o(e,[{key:"use",value:function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=e.apply(this,r);return o&&o.name&&(this._modules[o.name]=o),this}},{key:"unuse",value:function(e){var t=e;return"string"==typeof t&&(t=this._modules[t]),t&&t.unuse&&(t.name&&delete this._modules[t.name],t.unuse()),this}},{key:"modules",get:function(){return this._modules}}]),e}(),u=i.prototype,a={_modules:{},use:u.use,unuse:u.unuse},l=function(e){if(void 0!==e.use)return!1;var t=!0,r=!1,n=void 0;try{for(var o,i=Object.keys(a)[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var u=o.value;e[u]=a[u]}}catch(e){r=!0,n=e}finally{try{!t&&i.return&&i.return()}finally{if(r)throw n}}return e._modules={},Object.defineProperty(e,"modules",{value:e._modules,writable:!1}),!0},s={Modulable:i,enableModule:l,disableModule:function(e){if(void 0!==e.use){var t=!0,r=!1,n=void 0;try{for(var o,i=Object.keys(a)[Symbol.iterator]();!(t=(o=i.next()).done);t=!0)delete e[o.value]}catch(e){r=!0,n=e}finally{try{!t&&i.return&&i.return()}finally{if(r)throw n}}}}};if(void 0!==e&&e){e.jm||(e.jm={});var f=e.jm;if(!f.enableModule){for(var c in s)f[c]=s[c];l(f)}}r.default=s,t.exports=r.default}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],13:[function(e,t,r){(function(e){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={slice:function(e,t,r){t=t||0,r=r||e.length,t<0&&(t+=e.length),r<0&&(r+=e.length);for(var n=new Array(r-t),o=t;o<r;o++)n[o-t]=e[o];return n},formatJSON:function(e){return JSON.stringify(e,null,2)},getUriProtocol:function(e){return e?e.substring(0,e.indexOf(":")):null},getUriPath:function(e){var t=e.indexOf("//");return-1==t?"":-1==(t=e.indexOf("/",t+2))?"":(e=e.substr(t),-1==(t=e.indexOf("#"))&&(t=e.indexOf("?")),-1!=t&&(e=e.substr(0,t)),e)}},o={utils:n,moduleUtils:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"utils",t=this;return t[e]=n,{name:e,unuse:function(){delete t[e]}}}};if(void 0!==e&&e){e.jm||(e.jm={});var i=e.jm;if(!i.utils)for(var u in o)i[u]=o[u]}r.default=o,t.exports=r.default}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],14:[function(e,t,r){function n(e,t){for(var r,n=[],o=0,i=0,u="",s=t&&t.delimiter||"/";null!=(r=h.exec(e));){var f=r[0],c=r[1],d=r.index;if(u+=e.slice(i,d),i=d+f.length,c)u+=c[1];else{var p=e[i],v=r[2],y=r[3],m=r[4],g=r[5],b=r[6],_=r[7];u&&(n.push(u),u="");var j=null!=v&&null!=p&&p!==v,x="+"===b||"*"===b,w="?"===b||"*"===b,E=r[2]||s,A=m||g;n.push({name:y||o++,prefix:v||"",delimiter:E,optional:w,repeat:x,partial:j,asterisk:!!_,pattern:A?l(A):_?".*":"[^"+a(E)+"]+?"})}}return i<e.length&&(u+=e.substr(i)),u&&n.push(u),n}function o(e){return encodeURI(e).replace(/[\/?#]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}function i(e){return encodeURI(e).replace(/[?#]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}function u(e){for(var t=new Array(e.length),r=0;r<e.length;r++)"object"==typeof e[r]&&(t[r]=new RegExp("^(?:"+e[r].pattern+")$"));return function(r,n){for(var u="",a=r||{},l=(n||{}).pretty?o:encodeURIComponent,s=0;s<e.length;s++){var f=e[s];if("string"!=typeof f){var c,d=a[f.name];if(null==d){if(f.optional){f.partial&&(u+=f.prefix);continue}throw new TypeError('Expected "'+f.name+'" to be defined')}if(m(d)){if(!f.repeat)throw new TypeError('Expected "'+f.name+'" to not repeat, but received `'+JSON.stringify(d)+"`");if(0===d.length){if(f.optional)continue;throw new TypeError('Expected "'+f.name+'" to not be empty')}for(var p=0;p<d.length;p++){if(c=l(d[p]),!t[s].test(c))throw new TypeError('Expected all "'+f.name+'" to match "'+f.pattern+'", but received `'+JSON.stringify(c)+"`");u+=(0===p?f.prefix:f.delimiter)+c}}else{if(c=f.asterisk?i(d):l(d),!t[s].test(c))throw new TypeError('Expected "'+f.name+'" to match "'+f.pattern+'", but received "'+c+'"');u+=f.prefix+c}}else u+=f}return u}}function a(e){return e.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function l(e){return e.replace(/([=!:$\/()])/g,"\\$1")}function s(e,t){return e.keys=t,e}function f(e){return e.sensitive?"":"i"}function c(e,t){var r=e.source.match(/\((?!\?)/g);if(r)for(var n=0;n<r.length;n++)t.push({name:n,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return s(e,t)}function d(e,t,r){for(var n=[],o=0;o<e.length;o++)n.push(y(e[o],t,r).source);return s(new RegExp("(?:"+n.join("|")+")",f(r)),t)}function p(e,t,r){return v(n(e,r),t,r)}function v(e,t,r){m(t)||(r=t||r,t=[]);for(var n=(r=r||{}).strict,o=!1!==r.end,i="",u=0;u<e.length;u++){var l=e[u];if("string"==typeof l)i+=a(l);else{var c=a(l.prefix),d="(?:"+l.pattern+")";t.push(l),l.repeat&&(d+="(?:"+c+d+")*"),i+=d=l.optional?l.partial?c+"("+d+")?":"(?:"+c+"("+d+"))?":c+"("+d+")"}}var p=a(r.delimiter||"/"),v=i.slice(-p.length)===p;return n||(i=(v?i.slice(0,-p.length):i)+"(?:"+p+"(?=$))?"),i+=o?"$":n&&v?"":"(?="+p+"|$)",s(new RegExp("^"+i,f(r)),t)}function y(e,t,r){return m(t)||(r=t||r,t=[]),r=r||{},e instanceof RegExp?c(e,t):m(e)?d(e,t,r):p(e,t,r)}var m=e("isarray");t.exports=y,t.exports.parse=n,t.exports.compile=function(e,t){return u(n(e,t))},t.exports.tokensToFunction=u,t.exports.tokensToRegExp=v;var h=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))"].join("|"),"g")},{isarray:15}],15:[function(e,t,r){t.exports=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)}},{}],16:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var o=n(e("jm-ajax/lib/browser")),i=(0,n(e("../fnclient")).default)(o.default);r.default=i,t.exports=r.default},{"../fnclient":18,"jm-ajax/lib/browser":19}],17:[function(e,t,r){(function(n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=function(e){return e&&e.__esModule?e:{default:e}}(e("./client")),i={moduleClient:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ms-http-client",t=this;return t.clientModules.http=o.default,t.clientModules.https=o.default,{name:e,unuse:function(){delete t.clientModules.http}}}};if(void 0!==n&&n){n.jm||(n.jm={});var u=n.jm;if(u.ms)for(var a in i)u.ms.root.use(i[a])}i.client=o.default,r.default=i,t.exports=r.default}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./client":16}],18:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var o=n(e("jm-event")),i=n(e("jm-ms-core/lib/utils"));r.default=function(e){var t={};return e.enableAjax(t),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=null,u=e.uri||"http://localhost:3000",a=e.timeout||0;n={request:function(e,r){var n=i.default.preRequest.apply(this,arguments);e=n.opts,n.cb;var o=e.type||"get",l=e.headers||{};e.ips&&(l["X-Forwarded-For"]=e.ips.toString()),t[o]({url:u+e.uri,timeout:e.timeout||a,data:e.data,headers:l},n.cb)}},o.default.enableEvent(n),r&&r(null,n),n.emit("open")}},t.exports=r.default},{"jm-event":2,"jm-ms-core/lib/utils":7}],19:[function(e,t,r){(function(n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var i=o(e("jm-err")),u=o(e("./enableajax")),a=i.default.Err,l={};if(function(e){var t={extend:function(e){return t.each(Array.prototype.slice.call(arguments,1),function(t){for(var r in t)void 0!==t[r]&&(e[r]=t[r])}),e},each:function(e,t,r){if(null!==e)if(n&&e.forEach===n)e.forEach(t,r);else if(e.length===+e.length){for(var o=0,i=e.length;o<i;o++)if(o in e&&t.call(r,e[o],o,e)===breaker)return}else for(var u in e)if(hasOwnProperty.call(e,u)&&t.call(r,e[u],u,e)===breaker)return}},r={},n=Array.prototype.forEach,o=t.extend;r.xhr=function(){return new XMLHttpRequest},r._xhrResp=function(e){switch(e.getResponseHeader("Content-Type").split(";")[0]){case"text/xml":return e.responseXML;case"text/json":case"application/json":case"text/javascript":case"application/javascript":case"application/x-javascript":try{return JSON.parse(e.responseText)}catch(e){return a.FAIL}default:return e.responseText}},r._formData=function(e){var t=[],r=/%20/g;for(var n in e)void 0!=e[n]&&null!=e[n]&&t.push(encodeURIComponent(n).replace(r,"+")+"="+encodeURIComponent(e[n].toString()).replace(r,"+"));return t.join("&")},r.ajax=function(e){var t=r.xhr(),n=null,i=0;if("function"==typeof t.open){(e=o({userAgent:"XMLHttpRequest",lang:"en",type:"GET",data:null,contentType:"application/x-www-form-urlencoded"},e)).timeout&&(n=setTimeout(function(){e.error.timeout=!0,t.abort(),e.timeoutFn&&e.timeoutFn(e.url)},e.timeout)),t.onreadystatechange=function(){4==t.readyState?(null!=n&&(clearTimeout(n),n=null),t.status>=200&&t.status<300||304===t.status?e.success&&e.success(r._xhrResp(t)):e.error&&e.error(t,t.status,t.statusText),e.complete&&e.complete(r._xhrResp(t),t,t.statusText)):e.progress&&e.progress(++i)};var u=e.url,a=null;e.type=(e.type||"GET").toUpperCase();var l="POST"==e.type||"PUT"==e.type;if(!l&&e.data&&(u+="?"+r._formData(e.data)),t.open(e.type,u),e.headers)for(var s in e.headers)e.headers[s]&&t.setRequestHeader(s,e.headers[s]);if(l){var f=e.contentType.indexOf("json")>=0;a=f?JSON.stringify(e.data):r._formData(e.data),t.setRequestHeader("Content-Type",f?"application/json":"application/x-www-form-urlencoded")}a?t.send(a):t.send()}},e.ajax=r.ajax}(l),l.enableAjax=(0,u.default)(l),void 0!==n&&n){n.jm||(n.jm={});var s=n.jm;s.ajax||(s.ajax=l.ajax,s.enableAjax=l.enableAjax)}r.default=l,t.exports=r.default}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./enableajax":20,"jm-err":21}],20:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){return function(t,r){var n=(r=r||{}).ignoreDocErr||!1,o=r.types||["get","post","put","delete"],i=r.timeout||0;Array.isArray(o)||(o=[o]),o.forEach(function(r){t[r]=function(t,o){var l={};for(var s in t)l[s]=t[s];l.type=r.toUpperCase(),l.contentType=l.contentType||"application/json",l.dataType=l.dataType||"json",l.timeout=l.timeout||i,l.success=l.success||function(e){if(o){var t=null;e&&e.err&&!n&&(t=new Error(e.msg||e.err)),o(t,e)}},l.error=l.error||function(e,n,i){var s=r.toUpperCase()+" "+t.url;l.error.timeout&&(i=new Error("timeout")),i=i||new Error(s),a.debug("failed. "+s),o&&o(i,u.FA_NETWORK)},e.ajax(l)}})}};var o=n(e("jm-err")),i=n(e("jm-logger")),u=o.default.Err,a=i.default.getLogger("jm:ajax");t.exports=r.default},{"jm-err":21,"jm-logger":24}],21:[function(e,t,r){t.exports=e(8)},{"./locale":22}],22:[function(e,t,r){t.exports=e(9)},{"./zh_CN":23}],23:[function(e,t,r){t.exports=e(10)},{}],24:[function(e,t,r){(function(e){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(e){return console.debug||(console.debug=console.log),console},o={logger:n(),getLogger:n,moduleLogger:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"logger",t=this;return t.getLogger=n,t.logger=n(),{name:e,unuse:function(){delete t.logger,delete t.getLogger}}}};if(void 0!==e&&e){e.jm||(e.jm={});var i=e.jm;if(!i.logger)for(var u in o)i[u]=o[u]}r.default=o,t.exports=r.default}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],25:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var o=n(e("../fnclient")),i=n(e("./ws")),u=(0,o.default)(i.default);r.default=u,t.exports=r.default},{"../fnclient":28,"./ws":27}],26:[function(e,t,r){(function(n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=function(e){return e&&e.__esModule?e:{default:e}}(e("./client")),i={moduleClient:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ms-ws-client",t=this;return t.clientModules.ws=o.default,{name:e,unuse:function(){delete t.clientModules.ws}}}};if(void 0!==n&&n){n.jm||(n.jm={});var u=n.jm;if(u.ms)for(var a in i)u.ms.root.use(i[a])}i.client=o.default,r.default=i,t.exports=r.default}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./client":25}],27:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,t){var r=new WebSocket(e);return r.onmessage=function(e){t(e.data)},r},t.exports=r.default},{}],28:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(r,"__esModule",{value:!0});var o=n(e("jm-event")),i=n(e("jm-ms-core/lib/utils")),u=n(e("jm-err")),a=n(e("jm-logger")).default.getLogger("jm-ms-ws:client"),l=u.default.Err,s=u.default.err(l.FA_NETWORK);r.default=function(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=null,u=t.uri||"ws://localhost:3100",f=(t.timeout,!1),c=!1,d=0,p={},v=i.default.getUriPath(u),y=t.prefix||"";y=v+y;var m=null;n={request:function(e,t){var r=i.default.preRequest.apply(this,arguments);if(e=r.opts,t=r.cb,!f)return t(s,l.FA_NETWORK);e.uri=y+(e.uri||""),t&&(d>=999999&&(d=0),p[++d]=t,e.id=d),m.send(JSON.stringify(e))},close:function(){c=!1,f&&(m.close(),m=null)}},o.default.enableEvent(n);var h=function(e){a.debug("received: %s",e),n.emit("message",e);var t=null;try{t=JSON.parse(e)}catch(e){return}if(t.id&&p[t.id]){var r=null,o=t.data;o.err&&(r=new Error(o.msg)),p[t.id](r,o),delete p[t.id]}},g=!1,b=null,_=0,j=t.reconnectionDelay||5e3,x=t.maxReconnectAttempts||0;n.connect=function(){if(!f){a.debug("connect to "+u);var r=n;!c&&t.reconnect&&(c=t.reconnect,g=!1,_=0),(m=e(u,h)).onopen=function(e){a.debug("connected to "+u),f=!0,g&&r.emit("reconnect"),r.emit("open",e)},m.onerror=function(e){n.emit("error",e)},m.onclose=function(e){f=!1,r.emit("close",e),c&&(!x||_<x)&&(g=!0,_++,b=setTimeout(function(){r.connect()},j))}}},n.connect(),r&&r(null,n)}},t.exports=r.default},{"jm-err":29,"jm-event":32,"jm-logger":33,"jm-ms-core/lib/utils":7}],29:[function(e,t,r){t.exports=e(8)},{"./locale":30}],30:[function(e,t,r){t.exports=e(9)},{"./zh_CN":31}],31:[function(e,t,r){t.exports=e(10)},{}],32:[function(e,t,r){t.exports=e(2)},{}],33:[function(e,t,r){t.exports=e(24)},{}]},{},[1]);